<main>
  <div class = "container">
    <%= render 'partial_template/error', error: @user %>
    <%= form_with model: @user, url: users_information_path, method: :patch do |f| %>
      <div class = "row">
        <%= render 'partial_template/profire' %>
        <div class = "col-sm-10">
          <div class = "col-sm-11 offset-sm-1">
            <h3><i class="fas fa-user-edit"></i>プロフィール編集</h3>
          </div>
          <div class = "row">
            <div class = "col-sm-5">
              <%= f.file_field :profile_image, placeholder: "プロフィール画像", accept: "image/*", onchange: "profireImage(this);" %>
              <!--javascriptで選択した画像を表示 画像が無ければno_imageを表示-->
              <%= image_tag @user.get_profile_image(200,200), class: "mx-auto d-block preview" %>
            </div>
            <div class = "col-sm-5">
              <div class = "row">
                <div class = "col-sm-12">
                  ニックネーム
                </div>
                <div class = "col-sm-12">
                  <%= f.text_field :nickname, class:"form-control", id:"nickname" %>
                </div>
                <div class = "col-sm-12">
                  メールアドレス
                </div>
                <div class = "col-sm-12">
                  <%= f.email_field :email, class:"form-control", id:"email" %>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class = "col-sm-12 text-center mt-3">
          <%= f.submit "編集内容を保存", class: "btn btn-sm btn-success" %>
        </div>
      </div>
    <% end %>
  </div>
</main>

<!--プロフィール画像の貼付場所の指定-->
<script>
  // inputタグとの紐付用id
  function profireImage(obj)
  {
    var fileReader = new FileReader();
    // inputタグの兄弟要素のimgタグを指定
    var imgTag = $(obj).siblings('.preview')[0];
    fileReader.onload = (function() {
      //document.getElementById('test').src = fileReader.result;
      imgTag.src = fileReader.result;
    });
    fileReader.readAsDataURL(obj.files[0]);
  }
</script>