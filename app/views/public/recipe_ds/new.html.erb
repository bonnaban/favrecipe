<main>
  <div class = "container">
    <div class = "row">
      <div class = "col-sm-11 offset-sm-1">
        <h3><i class="fas fa-plus-circle"></i>レシピ投稿</h3>
      </div>
      <div class = "col-sm-12">
        <%= form_with model: @recipe_d, url: recipe_ds_path do |f| %>
          <div class = "row">
            <div class = "col-sm-6">
              <label>
                <!--javascriptで画像選択後、プレビュー表示 ここから-->
                <input type="file" accept='image/*' onchange="previewImage(this);">
                <img id="preview" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" style="max-width:200px;">
                <script>
                function previewImage(obj)
                {
                	var fileReader = new FileReader();
                	fileReader.onload = (function() {
                		document.getElementById('preview').src = fileReader.result;
                	});
                	fileReader.readAsDataURL(obj.files[0]);
                }
                </script>
                <!--ここまで-->
              </label>
            </div>
            <div class = "col-sm-6">

              <div class = "row">
                <div class = "col-sm-12">
                  <span>レシピ詳細</span>
                </div>
                <div class = "col-sm-2 mt-3">
                  料理名
                </div>
                <div class = "col-sm-9 mt-2">
                  <%= f.text_field :title, class:"form-control", :placeholder => "カレーライス" %>
                </div>
                <div class = "col-sm-2 mt-3">
                  料理説明
                </div>
                <div class = "col-sm-9 mt-2">
                  <%= f.text_area :explanation, class:"form-control", :placeholder => "簡単に作れて、おいしいです。" %>
                </div>
                <div class = "col-sm-12">
                  <span>材料</span>
                </div>

                <!--材料の追加・削除を行う動的フォームの記述 ここから-->
                <div class="recipe-ingredients">
                  <div class="mx-auto">
                    <%= f.fields_for :materials do |t| %>
                      <%= render "public/recipe_ds/material_fields", f: t %>
                    <% end %>
                  </div>
                  <!--フォームにidを与える-->
                  <div id="material-point"></div>
                  <!--与えたidを参照してフォームを”この場所”に追加する-->
                  <div class="col-10 mx-auto mt-2">
                    <%= link_to_add_association "+フォームを追加", f, :materials,
                    class: "btn btn-secondary btn-block",
                    data: {
                    association_insertion_node: '#material-point',
                    association_insertion_method: 'after'
                    }%>
                  </div>
                </div>
                <!--ここまで-->
              </div>
            </div>

            <div class = "col-sm-12">
              <span>作り方</span>
            </div>

            <!--手順の追加・削除を行う動的フォームの記述 ここから-->
            <div class="recipe-ingredients">
              <div class="mx-auto">
                <%= f.fields_for :procedures do |s| %>
                  <%= render "public/recipe_ds/procedure_fields", f: s %>
                <% end %>
              </div>
              <!--フォームにidを与える-->
              <div id="procedure-point"></div>
              <!--与えたidを参照してフォームを”この場所”に追加する-->
              <div class="col-10 mx-auto mt-2">
                <%= link_to_add_association "+フォームを追加", f, :procedures,
                class: "btn btn-secondary btn-block",
                data: {
                association_insertion_node: '#procedure-point',
                association_insertion_method: 'after'
                }%>
              </div>
            </div>
            <!--ここまで-->

            <%= f.submit "レシピ登録", class: "btn btn-sm btn-success" %>

          </div>
        <% end %>
      </div>
    </div>
  </div>
</main>